<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator RPP Pembelajaran Mendalam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Earth (Warm neutrals like stone, with a gentle teal accent) -->
    <!-- Application Structure Plan: A multi-step, task-oriented wizard interface to guide the user through creating an RPP. A new "Step 0" for primary parameters is added for better workflow. The linear flow (Parameter -> Identifikasi -> Desain -> Pengalaman -> Asesmen -> Finalisasi) is more intuitive for a document creation tool than a dashboard. Each step is a self-contained form, with interactive buttons to get AI-powered suggestions, promoting ease of use and reducing cognitive load. -->
    <!-- Visualization & Content Choices: The source is a template, not data. Therefore, the application is an interactive form builder. Goal: Guide user input. Method: Structured HTML forms with Tailwind CSS. Interaction: Buttons trigger JavaScript functions to provide mock AI suggestions, populating text areas. Goal: Preview final document. Method: JavaScript generates a clean HTML preview from user input. This avoids charts and focuses on user workflow and content generation, using only HTML, Tailwind, and Vanilla JS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f5; /* Neutral background */
        }
        .step-active {
            background-color: #0d9488; /* Teal 600 */
            color: white;
            border-color: #0d9488;
        }
        .step-inactive {
            background-color: #e7e5e4; /* Stone 200 */
            color: #57534e; /* Stone 600 */
            border-color: #d6d3d1; /* Stone 300 */
        }
        .form-input, .form-select {
            width: 100%;
            border-radius: 0.5rem;
            border: 1px solid #d6d3d1;
            padding: 0.75rem 1rem;
            transition: all 0.2s ease-in-out;
            background-color: white;
        }
        .form-select {
             -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #14b8a6; /* Teal 500 */
            box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.2);
        }
        .ai-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background-color: #ccfbf1; /* Teal 100 */
            color: #134e4a; /* Teal 900 */
            border-radius: 9999px;
            font-weight: 500;
            font-size: 0.875rem;
            transition: all 0.2s;
        }
        .ai-button:hover {
            background-color: #99f6e4; /* Teal 200 */
        }
        #rpp-preview-content {
            white-space: pre-wrap;
            font-family: 'Courier New', Courier, monospace;
            background-color: #1c1917;
            color: #f8f7f5;
            padding: 1.5rem;
            border-radius: 0.5rem;
            max-height: 80vh;
            overflow-y: auto;
        }
    </style>
</head>
<body class="text-stone-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-teal-800">Generator RPP Pembelajaran Mendalam</h1>
            <p class="text-lg text-stone-600 mt-2">Create by : Andi Subhan</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <aside class="lg:col-span-1">
                <nav id="step-navigation" class="sticky top-8 bg-white p-4 rounded-lg shadow-sm">
                    <ul class="space-y-2">
                        <li><a href="#" data-step="0" class="step-link flex items-center gap-3 p-3 rounded-md font-semibold transition-all step-active">
                            <span class="w-8 h-8 flex items-center justify-center rounded-full border-2 font-bold transition-all">1</span> Parameter Utama</a></li>
                        <li><a href="#" data-step="1" class="step-link flex items-center gap-3 p-3 rounded-md font-semibold transition-all step-inactive">
                            <span class="w-8 h-8 flex items-center justify-center rounded-full border-2 font-bold transition-all">2</span> Identifikasi</a></li>
                        <li><a href="#" data-step="2" class="step-link flex items-center gap-3 p-3 rounded-md font-semibold transition-all step-inactive">
                            <span class="w-8 h-8 flex items-center justify-center rounded-full border-2 font-bold transition-all">3</span> Desain</a></li>
                        <li><a href="#" data-step="3" class="step-link flex items-center gap-3 p-3 rounded-md font-semibold transition-all step-inactive">
                            <span class="w-8 h-8 flex items-center justify-center rounded-full border-2 font-bold transition-all">4</span> Pengalaman</a></li>
                        <li><a href="#" data-step="4" class="step-link flex items-center gap-3 p-3 rounded-md font-semibold transition-all step-inactive">
                            <span class="w-8 h-8 flex items-center justify-center rounded-full border-2 font-bold transition-all">5</span> Asesmen</a></li>
                        <li><a href="#" data-step="5" class="step-link flex items-center gap-3 p-3 rounded-md font-semibold transition-all step-inactive">
                            <span class="w-8 h-8 flex items-center justify-center rounded-full border-2 font-bold transition-all">6</span> Finalisasi</a></li>
                    </ul>
                </nav>
            </aside>

            <div class="lg:col-span-3">
                <form id="rpp-form">
                    <!-- Step 0: Parameter Utama -->
                    <section id="step-0" class="step-content bg-white p-6 md:p-8 rounded-lg shadow-md">
                        <h2 class="text-2xl font-bold mb-6 text-teal-700">1. Parameter Utama</h2>
                        <p class="mb-6 text-stone-600">Mulailah dengan mengisi informasi dasar untuk Rencana Pelaksanaan Pembelajaran Anda.</p>
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="font-semibold block mb-2">Satuan Pendidikan</label>
                                    <input type="text" id="satuan_pendidikan" class="form-input" placeholder="Contoh : SMA Negeri 2 Lubuklinggau">
                                </div>
                                <div>
                                    <label class="font-semibold block mb-2">Mata Pelajaran</label>
                                    <select id="mata_pelajaran" class="form-select">
                                        <option value="" disabled selected>Pilih Mata Pelajaran</option>
                                        <optgroup label="SD (Fase A, B, C)">
                                            <option value="Pendidikan Agama dan Budi Pekerti">Pendidikan Agama dan Budi Pekerti</option>
                                            <option value="Pendidikan Pancasila">Pendidikan Pancasila</option>
                                            <option value="Bahasa Indonesia">Bahasa Indonesia</option>
                                            <option value="Matematika">Matematika</option>
                                            <option value="Ilmu Pengetahuan Alam dan Sosial (IPAS)">Ilmu Pengetahuan Alam dan Sosial (IPAS)</option>
                                            <option value="Pendidikan Jasmani, Olahraga, dan Kesehatan (PJOK)">Pendidikan Jasmani, Olahraga, dan Kesehatan (PJOK)</option>
                                            <option value="Seni Budaya (Seni Musik)">Seni Budaya (Seni Musik)</option>
                                            <option value="Seni Budaya (Seni Rupa)">Seni Budaya (Seni Rupa)</option>
                                            <option value="Seni Budaya (Seni Teater)">Seni Budaya (Seni Teater)</option>
                                            <option value="Seni Budaya (Seni Tari)">Seni Budaya (Seni Tari)</option>
                                            <option value="Bahasa Inggris">Bahasa Inggris</option>
                                        </optgroup>
                                        <optgroup label="SMP (Fase D)">
                                            <option value="Pendidikan Agama dan Budi Pekerti">Pendidikan Agama dan Budi Pekerti</option>
                                            <option value="Pendidikan Pancasila">Pendidikan Pancasila</option>
                                            <option value="Bahasa Indonesia">Bahasa Indonesia</option>
                                            <option value="Matematika">Matematika</option>
                                            <option value="Ilmu Pengetahuan Alam (IPA)">Ilmu Pengetahuan Alam (IPA)</option>
                                            <option value="Ilmu Pengetahuan Sosial (IPS)">Ilmu Pengetahuan Sosial (IPS)</option>
                                            <option value="Bahasa Inggris">Bahasa Inggris</option>
                                            <option value="Pendidikan Jasmani, Olahraga, dan Kesehatan (PJOK)">Pendidikan Jasmani, Olahraga, dan Kesehatan (PJOK)</option>
                                            <option value="Informatika">Informatika</option>
                                            <option value="Seni Budaya (Seni Musik)">Seni Budaya (Seni Musik)</option>
                                            <option value="Seni Budaya (Seni Rupa)">Seni Budaya (Seni Rupa)</option>
                                            <option value="Seni Budaya (Seni Teater)">Seni Budaya (Seni Teater)</option>
                                            <option value="Seni Budaya (Seni Tari)">Seni Budaya (Seni Tari)</option>
                                            <option value="Prakarya">Prakarya</option>
                                        </optgroup>
                                        <optgroup label="SMA (Fase E & F - Umum)">
                                            <option value="Pendidikan Agama dan Budi Pekerti">Pendidikan Agama dan Budi Pekerti</option>
                                            <option value="Pendidikan Pancasila">Pendidikan Pancasila</option>
                                            <option value="Bahasa Indonesia">Bahasa Indonesia</option>
                                            <option value="Matematika">Matematika</option>
                                            <option value="Bahasa Inggris">Bahasa Inggris</option>
                                            <option value="Pendidikan Jasmani, Olahraga, dan Kesehatan (PJOK)">Pendidikan Jasmani, Olahraga, dan Kesehatan (PJOK)</option>
                                            <option value="Sejarah">Sejarah</option>
                                            <option value="Seni dan Budaya">Seni dan Budaya</option>
                                        </optgroup>
                                        <optgroup label="SMA (Fase E & F - Pilihan MIPA)">
                                            <option value="Biologi">Biologi</option>
                                            <option value="Kimia">Kimia</option>
                                            <option value="Fisika">Fisika</option>
                                            <option value="Matematika Tingkat Lanjut">Matematika Tingkat Lanjut</option>
                                        </optgroup>
                                        <optgroup label="SMA (Fase E & F - Pilihan IPS)">
                                            <option value="Sosiologi">Sosiologi</option>
                                            <option value="Ekonomi">Ekonomi</option>
                                            <option value="Geografi">Geografi</option>
                                        </optgroup>
                                         <optgroup label="SMK (Umum & Dasar Keahlian)">
                                            <option value="Pendidikan Agama dan Budi Pekerti">Pendidikan Agama dan Budi Pekerti</option>
                                            <option value="Pendidikan Pancasila">Pendidikan Pancasila</option>
                                            <option value="Bahasa Indonesia">Bahasa Indonesia</option>
                                            <option value="Matematika">Matematika</option>
                                            <option value="Bahasa Inggris">Bahasa Inggris</option>
                                            <option value="PJOK">PJOK</option>
                                            <option value="Sejarah">Sejarah</option>
                                            <option value="Informatika">Informatika</option>
                                            <option value="Projek Ilmu Pengetahuan Alam dan Sosial (IPAS)">Projek IPAS</option>
                                            <option value="Dasar-dasar Program Keahlian">Dasar-dasar Program Keahlian</option>
                                        </optgroup>
                                    </select>
                                </div>
                                <div>
                                    <label class="font-semibold block mb-2">Fase / Kelas</label>
                                    <select id="fase_kelas" class="form-select">
                                        <option value="" disabled selected>Pilih Fase dan Kelas</option>
                                        <optgroup label="PAUD">
                                            <option value="Fase Fondasi">Fase Fondasi</option>
                                        </optgroup>
                                        <optgroup label="SD">
                                            <option value="Fase A / Kelas 1">Fase A / Kelas 1</option>
                                            <option value="Fase A / Kelas 2">Fase A / Kelas 2</option>
                                            <option value="Fase B / Kelas 3">Fase B / Kelas 3</option>
                                            <option value="Fase B / Kelas 4">Fase B / Kelas 4</option>
                                            <option value="Fase C / Kelas 5">Fase C / Kelas 5</option>
                                            <option value="Fase C / Kelas 6">Fase C / Kelas 6</option>
                                        </optgroup>
                                        <optgroup label="SMP">
                                            <option value="Fase D / Kelas 7">Fase D / Kelas 7</option>
                                            <option value="Fase D / Kelas 8">Fase D / Kelas 8</option>
                                            <option value="Fase D / Kelas 9">Fase D / Kelas 9</option>
                                        </optgroup>
                                        <optgroup label="SMA / SMK">
                                            <option value="Fase E / Kelas 10">Fase E / Kelas 10</option>
                                            <option value="Fase F / Kelas 11">Fase F / Kelas 11</option>
                                            <option value="Fase F / Kelas 12">Fase F / Kelas 12</option>
                                        </optgroup>
                                         <optgroup label="SMK (4 Tahun)">
                                            <option value="Fase F / Kelas 13">Fase F / Kelas 13</option>
                                        </optgroup>
                                    </select>
                                </div>
                                <div>
                                    <label class="font-semibold block mb-2">Alokasi Waktu</label>
                                    <input type="text" id="alokasi_waktu" class="form-input" placeholder="Contoh: 2 Pertemuan (4 x 45 menit)">
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Step 1: Identifikasi -->
                    <section id="step-1" class="step-content bg-white p-6 md:p-8 rounded-lg shadow-md hidden">
                        <h2 class="text-2xl font-bold mb-6 text-teal-700">2. Identifikasi</h2>
                        <p class="mb-6 text-stone-600">Pahami konteks peserta didik dan materi untuk merancang pembelajaran yang relevan.</p>
                        <div class="space-y-6">
                            <div>
                                <label class="font-semibold block mb-2">Identifikasi Kesiapan Peserta Didik (opsional)</label>
                                <textarea id="kesiapan_peserta_didik" class="form-input h-24"></textarea>
                                <button type="button" class="ai-button mt-2" data-target="kesiapan_peserta_didik">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                            <div>
                                <label class="font-semibold block mb-2">Analisis Materi Pelajaran (opsional)</label>
                                <textarea id="analisis_materi" class="form-input h-24"></textarea>
                                <button type="button" class="ai-button mt-2" data-target="analisis_materi">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                            <div>
                                <label class="font-semibold block mb-2">Dimensi Profil Pelajar Pancasila</label>
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-3">
                                    <div class="flex items-center"><input type="checkbox" id="p3_1" value="Beriman, Bertakwa kepada Tuhan YME, dan Berakhlak Mulia" class="h-4 w-4 rounded mr-2"><label for="p3_1">Beriman & Bertakwa</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="p3_2" value="Berkebinekaan Global" class="h-4 w-4 rounded mr-2"><label for="p3_2">Berkebinekaan Global</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="p3_3" value="Gotong Royong" class="h-4 w-4 rounded mr-2"><label for="p3_3">Gotong Royong</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="p3_4" value="Mandiri" class="h-4 w-4 rounded mr-2"><label for="p3_4">Mandiri</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="p3_5" value="Bernalar Kritis" class="h-4 w-4 rounded mr-2"><label for="p3_5">Bernalar Kritis</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="p3_6" value="Kreatif" class="h-4 w-4 rounded mr-2"><label for="p3_6">Kreatif</label></div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Step 2: Desain Pembelajaran -->
                    <section id="step-2" class="step-content bg-white p-6 md:p-8 rounded-lg shadow-md hidden">
                        <h2 class="text-2xl font-bold mb-6 text-teal-700">3. Desain Pembelajaran</h2>
                         <p class="mb-6 text-stone-600">Rumuskan tujuan dan strategi untuk mencapai target pembelajaran.</p>
                        <div class="space-y-6">
                            <div>
                                <label class="font-semibold block mb-2">Capaian Pembelajaran (opsional)</label>
                                <textarea id="capaian_pembelajaran" class="form-input h-24" placeholder="Salin Capaian Pembelajaran (CP) dari dokumen kurikulum"></textarea>
                            </div>
                            <div><label class="font-semibold block mb-2">Topik Pembelajaran</label><input type="text" id="topik_pembelajaran" class="form-input"></div>
                            <div>
                                <label class="font-semibold block mb-2">Lintas Disiplin Ilmu (opsional)</label>
                                <textarea id="lintas_disiplin" class="form-input h-24" placeholder="Contoh: Seni Budaya (menggambar), Bahasa Indonesia (menulis laporan)"></textarea>
                                <button type="button" class="ai-button mt-2" data-target="lintas_disiplin">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                            <div>
                                <label class="font-semibold block mb-2">Tujuan Pembelajaran</label>
                                <textarea id="tujuan_pembelajaran" class="form-input h-24" placeholder="salin dan tempel tujuan pembelajaran materi anda pada sub menu Tujuan Pembelajaran"></textarea>
                            </div>
                             <div>
                                <label class="font-semibold block mb-2">Praktik Pedagogis (Model/Strategi/Metode pembelajaran)</label>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div>
                                        <label for="model_pembelajaran" class="text-sm font-medium text-stone-600">Model Pembelajaran</label>
                                        <select id="model_pembelajaran" class="form-select mt-1">
                                            <option value="">Pilih Model</option>
                                            <option value="Project-Based Learning (PjBL)">Project-Based Learning (PjBL)</option>
                                            <option value="Problem-Based Learning (PBL)">Problem-Based Learning (PBL)</option>
                                            <option value="Inquiry-Based Learning">Inquiry-Based Learning</option>
                                            <option value="Discovery Learning">Discovery Learning</option>
                                            <option value="Blended Learning">Blended Learning</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="strategi_pembelajaran" class="text-sm font-medium text-stone-600">Strategi Pembelajaran</label>
                                        <select id="strategi_pembelajaran" class="form-select mt-1">
                                             <option value="">Pilih Strategi</option>
                                             <option value="Pembelajaran Berdiferensiasi">Pembelajaran Berdiferensiasi</option>
                                             <option value="Pembelajaran Kolaboratif">Pembelajaran Kolaboratif</option>
                                             <option value="Pembelajaran Kontekstual">Pembelajaran Kontekstual</option>
                                             <option value="Pembelajaran Aktif">Pembelajaran Aktif</option>
                                             <option value="Flipped Classroom">Flipped Classroom</option>
                                             <option value="Gamifikasi">Gamifikasi</option>
                                             <option value="Pengajaran Langsung">Pengajaran Langsung</option>
                                             <option value="Pembelajaran Tematik">Pembelajaran Tematik</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="metode_pembelajaran" class="text-sm font-medium text-stone-600">Metode Pembelajaran</label>
                                        <select id="metode_pembelajaran" class="form-select mt-1">
                                            <option value="">Pilih Metode</option>
                                            <option value="Diskusi Kelompok">Diskusi Kelompok</option>
                                            <option value="Tanya Jawab">Tanya Jawab</option>
                                            <option value="Presentasi">Presentasi</option>
                                            <option value="Demonstrasi">Demonstrasi</option>
                                            <option value="Resitasi">Resitasi</option>
                                            <option value="Simulasi">Simulasi</option>
                                            <option value="Eksperimen">Eksperimen</option>
                                            <option value="Karya Wisata">Karya Wisata</option>
                                            <option value="Kuis">Kuis</option>
                                            <option value="Studi Kasus">Studi Kasus</option>
                                            <option value="Mind Mapping">Mind Mapping</option>
                                            <option value="Role Playing">Role Playing</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea id="praktik_pedagogis_deskripsi" class="form-input h-24 mt-4" placeholder="Deskripsi atau saran dari AI akan muncul di sini..."></textarea>
                                <button type="button" class="ai-button mt-2" data-target="praktik_pedagogis">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                            <div>
                                <label class="font-semibold block mb-2">Kemitraan Pembelajaran (opsional)</label>
                                <textarea id="kemitraan_pembelajaran" class="form-input h-24"></textarea>
                                <button type="button" class="ai-button mt-2" data-target="kemitraan_pembelajaran">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                            <div>
                                <label class="font-semibold block mb-2">Lingkungan Pembelajaran</label>
                                <textarea id="lingkungan_pembelajaran" class="form-input h-24"></textarea>
                                <button type="button" class="ai-button mt-2" data-target="lingkungan_pembelajaran">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                            <div>
                                <label class="font-semibold block mb-2">Pemanfaatan Digital (opsional)</label>
                                <textarea id="pemanfaatan_digital" class="form-input h-24"></textarea>
                                <button type="button" class="ai-button mt-2" data-target="pemanfaatan_digital">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Step 3: Pengalaman Belajar -->
                    <section id="step-3" class="step-content bg-white p-6 md:p-8 rounded-lg shadow-md hidden">
                         <h2 class="text-2xl font-bold mb-6 text-teal-700">4. Pengalaman Belajar</h2>
                         <p class="mb-6 text-stone-600">Rancang alur kegiatan yang bermakna dari awal hingga akhir.</p>
                        <div class="space-y-6">
                            <div class="p-4 border border-stone-200 rounded-lg">
                                <h3 class="font-bold text-lg mb-2">Kegiatan Awal</h3>
                                <textarea id="kegiatan_awal" class="form-input h-28" placeholder="Deskripsikan kegiatan pembuka..."></textarea>
                                <button type="button" class="ai-button mt-2" data-target="kegiatan_awal">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                            
                            <div class="p-4 border border-stone-200 rounded-lg">
                                <h3 class="font-bold text-lg">INTI (opsional)</h3>
                                <p class="text-sm text-stone-700 mt-1">Pada tahap ini, siswa aktif terlibat dalam pengalaman belajar memahami, mengaplikasi, dan merefleksi. Guru menerapkan prinsip pembelajaran berkesadaran, bermakna, menyenangkan untuk mencapai tujuan pembelajaran. Pengalaman belajar tidak harus dilaksanakan dalam satu kali pertemuan.</p>
                            </div>
                            
                            <div class="p-4 border border-stone-200 rounded-lg">
                                <label for="kegiatan_memahami" class="font-semibold block mb-2">Memahami <span class="font-normal text-sm">(prinsip: berkesadaran, bermakna, dan/atau menggembirakan)</span></label>
                                <textarea id="kegiatan_memahami" class="form-input h-28" placeholder="Tuliskan kegiatan yang memfasilitasi peserta didik untuk terlibat aktif mengonstruksi pengetahuan..."></textarea>
                                <button type="button" class="ai-button mt-2" data-target="kegiatan_memahami">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                    
                            <div class="p-4 border border-stone-200 rounded-lg">
                                <label for="kegiatan_mengaplikasi" class="font-semibold block mb-2">Mengaplikasi <span class="font-normal text-sm">(prinsip: berkesadaran, bermakna, dan/atau menggembirakan)</span></label>
                                <textarea id="kegiatan_mengaplikasi" class="form-input h-28" placeholder="Tuliskan kegiatan yang mengondisikan pengalaman belajar yang menunjukan aktivitas peserta didik mengaplikasi pemahaman..."></textarea>
                                <button type="button" class="ai-button mt-2" data-target="kegiatan_mengaplikasi">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                            
                            <div class="p-4 border border-stone-200 rounded-lg">
                                <label for="kegiatan_merefleksi" class="font-semibold block mb-2">Merefleksi <span class="font-normal text-sm">(prinsip: berkesadaran, bermakna, dan/atau menggembirakan)</span></label>
                                <textarea id="kegiatan_merefleksi" class="form-input h-28" placeholder="Tuliskan kegiatan yang mampu memfasilitasi peserta didik..."></textarea>
                                <button type="button" class="ai-button mt-2" data-target="kegiatan_merefleksi">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                    
                            <div class="p-4 border border-stone-200 rounded-lg">
                                <h3 class="font-bold text-lg mb-2">Kegiatan Penutup</h3>
                                <textarea id="kegiatan_penutup" class="form-input h-28" placeholder="Deskripsikan kegiatan penutup..."></textarea>
                                <button type="button" class="ai-button mt-2" data-target="kegiatan_penutup">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                        </div>
                    </section>

                    <!-- Step 4: Asesmen -->
                    <section id="step-4" class="step-content bg-white p-6 md:p-8 rounded-lg shadow-md hidden">
                        <h2 class="text-2xl font-bold mb-6 text-teal-700">5. Asesmen</h2>
                        <p class="mb-6 text-stone-600">Tentukan cara mengukur ketercapaian tujuan pembelajaran di setiap tahapannya.</p>
                        <div class="space-y-8">
                             <div class="p-4 border border-stone-200 rounded-lg">
                                <h3 class="font-bold text-lg mb-2">Asesmen Awal (Diagnostik)</h3>
                                <textarea id="asesmen_awal" class="form-input h-24"></textarea>
                                <button type="button" class="ai-button mt-2" data-target="asesmen_awal">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                             <div class="p-4 border border-stone-200 rounded-lg">
                                <h3 class="font-bold text-lg mb-2">Asesmen Proses (Formatif)</h3>
                                <textarea id="asesmen_proses" class="form-input h-24"></textarea>
                                <button type="button" class="ai-button mt-2" data-target="asesmen_proses">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                             <div class="p-4 border border-stone-200 rounded-lg">
                                <h3 class="font-bold text-lg mb-2">Asesmen Akhir (Sumatif)</h3>
                                <textarea id="asesmen_akhir" class="form-input h-24"></textarea>
                                <button type="button" class="ai-button mt-2" data-target="asesmen_akhir">ðŸ’¡ Dapatkan Saran AI</button>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Step 5: Finalisasi -->
                    <section id="step-5" class="step-content bg-white p-6 md:p-8 rounded-lg shadow-md hidden">
                        <h2 class="text-2xl font-bold mb-6 text-teal-700">6. Finalisasi & Pratinjau</h2>
                        <p class="mb-6 text-stone-600">Lengkapi detail pengesahan dan lihat hasil akhir RPP Anda.</p>
                        <div class="space-y-6">
                            <div>
                                <label class="font-semibold block mb-2">Tempat & Tanggal</label>
                                <input type="text" id="tempat_tanggal" class="form-input" placeholder="Contoh: Palembang, 30 Juni 2025">
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div class="space-y-2">
                                    <label class="font-semibold block">Kepala Sekolah</label>
                                    <input type="text" id="nama_kepsek" class="form-input" placeholder="Nama Lengkap">
                                    <input type="text" id="nip_kepsek" class="form-input" placeholder="NIP (jika ada)">
                                </div>
                                <div class="space-y-2">
                                    <label class="font-semibold block">Guru</label>
                                    <input type="text" id="nama_guru" class="form-input" placeholder="Nama Lengkap">
                                    <input type="text" id="nip_guru" class="form-input" placeholder="NIP (jika ada)">
                                </div>
                            </div>
                            <div class="text-center pt-4">
                                <button type="button" id="generate-rpp-btn" class="w-full md:w-auto bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition-all">
                                    âœ¨ Buat RPP Saya!
                                </button>
                            </div>
                        </div>
                    </section>
                </form>

                 <div class="flex justify-between mt-8">
                    <button id="prev-btn" class="bg-stone-300 hover:bg-stone-400 text-stone-800 font-bold py-2 px-6 rounded-lg transition-all disabled:opacity-50" disabled>Sebelumnya</button>
                    <button id="next-btn" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-6 rounded-lg transition-all">Selanjutnya</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal for RPP Preview -->
    <div id="rpp-preview-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-xl font-bold text-teal-800">Pratinjau RPP</h3>
                <button id="close-modal-btn" class="text-stone-500 hover:text-stone-800">&times;</button>
            </div>
            <div class="p-6 flex-grow overflow-y-auto">
                <pre id="rpp-preview-content"></pre>
            </div>
            <div class="p-4 border-t flex justify-end gap-3">
                 <button id="back-to-home-btn" class="bg-stone-200 hover:bg-stone-300 text-stone-800 font-semibold py-2 px-4 rounded-lg flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-3.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146z"/>
                    </svg>
                    Kembali ke Awal
                 </button>
                 <button id="export-doc-btn" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg">Export ke Dokumen</button>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let currentStep = 0;
            const totalSteps = 6;

            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const stepLinks = document.querySelectorAll('.step-link');
            const stepContents = document.querySelectorAll('.step-content');
            const aiButtons = document.querySelectorAll('.ai-button');
            const generateBtn = document.getElementById('generate-rpp-btn');
            const modal = document.getElementById('rpp-preview-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const backToHomeBtn = document.getElementById('back-to-home-btn');
            const exportDocBtn = document.getElementById('export-doc-btn');
            const rppPreviewContent = document.getElementById('rpp-preview-content');

            function updateStepUI() {
                stepContents.forEach(content => content.classList.add('hidden'));
                document.getElementById(`step-${currentStep}`).classList.remove('hidden');

                stepLinks.forEach(link => {
                    const linkSpan = link.querySelector('span');
                    if (link.dataset.step == currentStep) {
                        link.classList.remove('step-inactive');
                        link.classList.add('step-active');
                    } else {
                        link.classList.remove('step-active');
                        link.classList.add('step-inactive');
                    }
                });
                
                prevBtn.disabled = currentStep === 0;
                nextBtn.disabled = currentStep === (totalSteps - 1);
                nextBtn.style.display = currentStep === (totalSteps - 1) ? 'none' : 'block';
            }

            function navigateToStep(step) {
                currentStep = parseInt(step);
                updateStepUI();
            }

            prevBtn.addEventListener('click', () => {
                if (currentStep > 0) {
                    currentStep--;
                    updateStepUI();
                }
            });

            nextBtn.addEventListener('click', () => {
                if (currentStep < (totalSteps - 1)) {
                    currentStep++;
                    updateStepUI();
                }
            });

            stepLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateToStep(link.dataset.step);
                });
            });

            async function getAISuggestion(targetId) {
                const topic = document.getElementById('topik_pembelajaran').value || '[Topik Anda]';
                let prompt = '';
                let suggestion = '';

                // Simulate creating a prompt for an API
                switch (targetId) {
                    case 'kesiapan_peserta_didik':
                        prompt = `Berikan saran identifikasi kesiapan peserta didik untuk topik: ${topic}`;
                        suggestion = `Lakukan asesmen diagnostik awal dengan memberikan 3 pertanyaan terbuka tentang ${topic} untuk mengetahui pemahaman awal siswa. Contoh: 1. Apa yang kamu ketahui tentang ${topic}? 2. Di mana kamu pernah melihat atau mendengar tentang ${topic}?`;
                        break;
                    case 'analisis_materi':
                        const tujuanText = document.getElementById('tujuan_pembelajaran').value;
                        prompt = `Berikan saran analisis materi untuk topik "${topic}" dengan tujuan pembelajaran: ${tujuanText || 'belum ditentukan'}`;
                        if (tujuanText.trim() !== '') {
                            suggestion = `Berdasarkan tujuan pembelajaran yang Anda tetapkan, analisis materi sebaiknya fokus pada konsep kunci yang mendukung pencapaian tujuan tersebut. Pastikan materi mencakup aspek faktual, konseptual, dan prosedural yang relevan dengan topik "${topic}".`;
                        } else {
                            suggestion = `Materi ${topic} memiliki potensi untuk dihubungkan dengan isu lingkungan lokal. Tekankan pada aspek sebab-akibat dan dampaknya dalam kehidupan sehari-hari untuk meningkatkan relevansi bagi siswa. (Tips: Isi Tujuan Pembelajaran terlebih dahulu untuk saran yang lebih spesifik).`;
                        }
                        break;
                    case 'lintas_disiplin':
                        prompt = `Berikan saran lintas disiplin ilmu untuk topik: ${topic}`;
                        suggestion = `Untuk topik "${topic}", pertimbangkan integrasi dengan:\n- Seni Budaya: Siswa dapat membuat poster atau lagu tentang ${topic}.\n- Bahasa Indonesia: Siswa menulis laporan hasil pengamatan atau membuat puisi bertema ${topic}.\n- Matematika: Siswa menghitung data statistik terkait ${topic}.`;
                        break;
                    case 'praktik_pedagogis':
                        const model = document.getElementById('model_pembelajaran').value || '[Model belum dipilih]';
                        const strategi = document.getElementById('strategi_pembelajaran').value || '[Strategi belum dipilih]';
                        const metode = document.getElementById('metode_pembelajaran').value || '[Metode belum dipilih]';
                        prompt = `Berikan saran deskripsi praktik pedagogis dengan model "${model}", strategi "${strategi}", dan metode "${metode}" untuk topik "${topic}".`;
                        suggestion = `Kombinasi yang baik! Untuk topik ${topic}, gunakan model "${model}" dengan strategi "${strategi}". Terapkan secara konkret melalui metode "${metode}" untuk mendorong partisipasi aktif dan pemahaman mendalam pada siswa.`;
                        break;
                    case 'kemitraan_pembelajaran':
                        prompt = `Berikan saran kemitraan pembelajaran untuk topik: ${topic}`;
                        suggestion = `Untuk topik "${topic}", jalin kemitraan dengan:\n- Narasumber: Undang seorang profesional atau praktisi yang relevan dengan topik untuk berbagi pengalaman.\n- Komunitas Lokal: Ajak siswa untuk melakukan observasi atau wawancara dengan komunitas sekitar.\n- Dunia Usaha: Lakukan kunjungan belajar ke perusahaan terkait atau undang perwakilan mereka ke sekolah.`;
                        break;
                    case 'lingkungan_pembelajaran':
                        prompt = `Berikan saran lingkungan pembelajaran untuk topik: ${topic}`;
                        suggestion = `Ciptakan lingkungan belajar yang positif dan inklusif. Atur tempat duduk menjadi bentuk U atau kelompok kecil untuk mendorong diskusi. Buat 'dinding karya' untuk memajang hasil kerja siswa dan memberikan apresiasi.`;
                        break;
                    case 'pemanfaatan_digital':
                         prompt = `Berikan saran pemanfaatan digital untuk topik: ${topic}`;
                        suggestion = `Gunakan video pembelajaran dari YouTube untuk pengantar. Manfaatkan platform seperti Padlet atau Jamboard untuk kegiatan curah pendapat secara kolaboratif. Untuk asesmen, gunakan kuis interaktif dari Kahoot! atau Quizizz.`;
                        break;
                    case 'kegiatan_awal':
                         prompt = `Berikan saran kegiatan awal untuk topik: ${topic}`;
                        suggestion = `Mulai dengan pertanyaan pemantik yang mengejutkan: "Jika semua air di dunia tiba-tiba berhenti bergerak, apa yang akan terjadi?". Lanjutkan dengan video animasi singkat (2-3 menit) tentang ${topic} untuk membangkitkan minat.`;
                        break;
                    case 'kegiatan_memahami':
                        prompt = `Berikan saran kegiatan memahami untuk topik: ${topic}`;
                        suggestion = `Siswa secara berkelompok melakukan studi literasi dari berbagai sumber (buku paket, artikel online, video) untuk mengumpulkan informasi kunci tentang tahapan-tahapan ${topic}. Hasilnya dituangkan dalam peta konsep digital (misal: menggunakan Miro/Jamboard).`;
                        break;
                    case 'kegiatan_mengaplikasi':
                        prompt = `Berikan saran kegiatan mengaplikasi untuk topik: ${topic}`;
                        suggestion = `Siswa memulai proyek pembuatan model/diorama ${topic} menggunakan bahan daur ulang. Guru memfasilitasi dan memastikan setiap anggota kelompok berkontribusi.`;
                        break;
                    case 'kegiatan_merefleksi':
                        prompt = `Berikan saran kegiatan merefleksi untuk topik: ${topic}`;
                        suggestion = `Setiap kelompok mempresentasikan hasil karyanya. Setelah presentasi, adakan sesi refleksi dengan pertanyaan: "Apa bagian tersulit dari proyek ini?", "Apa hal baru yang kamu pelajari?", "Bagaimana kamu bisa menerapkan pengetahuan ini?". Gunakan metode 'exit ticket' di akhir.`;
                        break;
                    case 'kegiatan_penutup':
                        prompt = `Berikan saran kegiatan penutup untuk topik: ${topic}`;
                        suggestion = `Bersama siswa, simpulkan 3 poin terpenting dari pembelajaran hari ini. Berikan umpan balik positif pada hasil karya siswa dan ingatkan tentang pentingnya menjaga ${topic} dalam kehidupan.`;
                        break;
                     case 'asesmen_awal':
                        prompt = `Berikan saran asesmen awal untuk topik: ${topic}`;
                        suggestion = `Gunakan kuis singkat di platform seperti Kahoot! atau Google Forms dengan 5 pertanyaan dasar mengenai ${topic} untuk memetakan pengetahuan awal siswa.`;
                        break;
                    case 'asesmen_proses':
                        prompt = `Berikan saran asesmen proses untuk topik: ${topic}`;
                        suggestion = `Gunakan lembar observasi untuk menilai kemampuan kolaborasi dan bernalar kritis siswa selama pengerjaan proyek. Lakukan penilaian sejawat (peer assessment) di mana siswa memberikan masukan pada karya kelompok lain.`;
                        break;
                    case 'asesmen_akhir':
                        prompt = `Berikan saran asesmen akhir untuk topik: ${topic}`;
                        suggestion = `Gunakan rubrik penilaian untuk asesmen produk (diorama/poster) dan presentasi. Kriteria mencakup: akurasi konten, kreativitas, kejelasan penyampaian, dan kerja sama tim.`;
                        break;
                }
                
                // This is where you would make a real API call.
                // For now, we simulate the process and return the hardcoded suggestion.
                console.log(`API Call simulation with prompt: "${prompt}"`);
                
                return suggestion;
            }

            aiButtons.forEach(button => {
                button.addEventListener('click', async () => {
                    const targetId = button.dataset.target;
                    let targetTextarea;
                     if (targetId === 'praktik_pedagogis') {
                         targetTextarea = document.getElementById('praktik_pedagogis_deskripsi');
                    } else {
                         targetTextarea = document.getElementById(targetId);
                    }
                    if (targetTextarea) {
                        targetTextarea.value = "Memproses saran...";
                        const suggestion = await getAISuggestion(targetId);
                        targetTextarea.value = suggestion;
                    }
                });
            });
            
            function getGeneratedRPPText() {
                const topikPembelajaran = document.getElementById('topik_pembelajaran').value || '[Topik Anda]';
                let output = `RPP Pembelajaran Mendalam Materi ${topikPembelajaran}\n\n`;
                output += `# RENCANA PELAKSANAAN PEMBELAJARAN (RPP)\n\n`;
                output += `### A. INFORMASI UMUM\n`;
                output += `Satuan Pendidikan : ${document.getElementById('satuan_pendidikan').value || '[...]'}\n`;
                output += `Mata Pelajaran    : ${document.getElementById('mata_pelajaran').value || '[...]'}\n`;
                output += `Fase / Kelas      : ${document.getElementById('fase_kelas').value || '[...]'}\n`;
                output += `Alokasi Waktu     : ${document.getElementById('alokasi_waktu').value || '[...]'}\n\n`;

                output += `### B. KOMPONEN INTI\n`;
                output += `1. Identifikasi\n`;
                if (document.getElementById('kesiapan_peserta_didik').value) {
                    output += `   - Kesiapan Peserta Didik: ${document.getElementById('kesiapan_peserta_didik').value.replace(/\n/g, '\n     ')}\n`;
                }
                 if (document.getElementById('analisis_materi').value) {
                    output += `   - Analisis Materi Pelajaran: ${document.getElementById('analisis_materi').value.replace(/\n/g, '\n     ')}\n`;
                }
                
                const p3Checkboxes = document.querySelectorAll('input[id^="p3_"]:checked');
                let p3Values = Array.from(p3Checkboxes).map(cb => cb.value);
                if (p3Values.length > 0) {
                     output += `   - Dimensi Profil Pelajar Pancasila: \n     - ${p3Values.join('\n     - ')}\n\n`;
                }

                output += `2. Desain Pembelajaran\n`;
                if (document.getElementById('capaian_pembelajaran').value) {
                    output += `   - Capaian Pembelajaran: ${document.getElementById('capaian_pembelajaran').value.replace(/\n/g, '\n     ')}\n`;
                }
                output += `   - Topik Pembelajaran  : ${topikPembelajaran}\n`;
                 if (document.getElementById('lintas_disiplin').value) {
                    output += `   - Lintas Disiplin Ilmu: ${document.getElementById('lintas_disiplin').value.replace(/\n/g, '\n     ')}\n`;
                }
                const tujuan = document.getElementById('tujuan_pembelajaran').value.split('\n').filter(t => t.trim() !== '').map(t => `     - ${t.trim()}`).join('\n');
                output += `   - Tujuan Pembelajaran:\n${tujuan || '     - [...]'}\n\n`;
                
                output += `   - Praktik Pedagogis:\n`;
                output += `     - Model: ${document.getElementById('model_pembelajaran').value || 'Tidak dipilih'}\n`;
                output += `     - Strategi: ${document.getElementById('strategi_pembelajaran').value || 'Tidak dipilih'}\n`;
                output += `     - Metode: ${document.getElementById('metode_pembelajaran').value || 'Tidak dipilih'}\n`;
                if (document.getElementById('praktik_pedagogis_deskripsi').value) {
                    output += `     - Deskripsi: ${document.getElementById('praktik_pedagogis_deskripsi').value.replace(/\n/g, '\n       ')}\n`;
                }
                output += `\n`;
                
                if (document.getElementById('kemitraan_pembelajaran').value) {
                    output += `   - Kemitraan Pembelajaran: ${document.getElementById('kemitraan_pembelajaran').value.replace(/\n/g, '\n     ')}\n`;
                }
                if(document.getElementById('lingkungan_pembelajaran').value) {
                    output += `   - Lingkungan Pembelajaran: ${document.getElementById('lingkungan_pembelajaran').value.replace(/\n/g, '\n     ')}\n`;
                }
                 if (document.getElementById('pemanfaatan_digital').value) {
                    output += `   - Pemanfaatan Digital: ${document.getElementById('pemanfaatan_digital').value.replace(/\n/g, '\n     ')}\n\n`;
                }

                output += `3. Pengalaman Belajar (Langkah-Langkah Pembelajaran)\n`;
                output += `   a. Kegiatan Awal\n      ${document.getElementById('kegiatan_awal').value.replace(/\n/g, '\n      ') || '[...]'}\n\n`;
                output += `   b. Kegiatan Inti\n`;
                output += `      - Memahami:\n        ${document.getElementById('kegiatan_memahami').value.replace(/\n/g, '\n        ') || '[...]'}\n\n`;
                output += `      - Mengaplikasi:\n        ${document.getElementById('kegiatan_mengaplikasi').value.replace(/\n/g, '\n        ') || '[...]'}\n\n`;
                output += `      - Merefleksi:\n        ${document.getElementById('kegiatan_merefleksi').value.replace(/\n/g, '\n        ') || '[...]'}\n\n`;
                output += `   c. Kegiatan Penutup\n      ${document.getElementById('kegiatan_penutup').value.replace(/\n/g, '\n      ') || '[...]'}\n\n`;

                output += `4. Asesmen\n`;
                output += `   - Asesmen Awal (Diagnostik): ${document.getElementById('asesmen_awal').value.replace(/\n/g, '\n     ') || '[...]'}\n`;
                output += `   - Asesmen Proses (Formatif): ${document.getElementById('asesmen_proses').value.replace(/\n/g, '\n     ') || '[...]'}\n`;
                output += `   - Asesmen Akhir (Sumatif): ${document.getElementById('asesmen_akhir').value.replace(/\n/g, '\n     ') || '[...]'}\n\n`;

                output += `---\n\n`;
                const kepsek = document.getElementById('nama_kepsek').value || '[Nama Lengkap]';
                const nipKepsek = document.getElementById('nip_kepsek').value;
                const guru = document.getElementById('nama_guru').value || '[Nama Lengkap]';
                const nipGuru = document.getElementById('nip_guru').value;
                const tempatTanggal = document.getElementById('tempat_tanggal').value || '[Tempat], [Tanggal]';

                output += `Mengetahui,\t\t\t\t\t\t${tempatTanggal}\n`;
                output += `Kepala Sekolah,\t\t\t\t\t\tGuru Mata Pelajaran,\n\n\n\n`;
                output += `${kepsek}\t\t\t\t${guru}\n`;
                output += `NIP. ${nipKepsek || '....................'}\t\t\t\tNIP. ${nipGuru || '....................'}`;
                
                return output;
            }
            
            generateBtn.addEventListener('click', () => {
                rppPreviewContent.textContent = getGeneratedRPPText();
                modal.classList.remove('hidden');
            });

            closeModalBtn.addEventListener('click', () => {
                modal.classList.add('hidden');
            });
            
            backToHomeBtn.addEventListener('click', () => {
                modal.classList.add('hidden');
                navigateToStep(0);
            });

            exportDocBtn.addEventListener('click', () => {
                const textToExport = getGeneratedRPPText();
                const blob = new Blob([textToExport], { type: 'application/msword' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `RPP_${(document.getElementById('topik_pembelajaran').value || 'Topik').replace(/ /g, '_')}.doc`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });

            updateStepUI();
        });
    </script>
</body>
</html>
